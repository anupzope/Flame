$include "FVM.lh"
$include "flame.lh"

#include <Loci.h>

namespace flame {

$rule unit(totalVolume), constraint(geom_cells) {
  $totalVolume = 0.0;
}

$rule apply(totalVolume <- vol)[Loci::Summation] {
  join($totalVolume, $vol);
}

$rule unit(totalKE), constraint(geom_cells) {
  $totalKE = 0.0;
}

$rule apply(totalKE <- vol, velocity, density)[Loci::Summation] {
  double const cellKE = 0.5*$density*dot($velocity,$velocity)*$vol;
  join($totalKE, cellKE);
}

} // end: namespace flame